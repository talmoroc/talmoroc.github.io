<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Le Jeu des Visages</title>
    <style>
        /* Reset default browser styles */
        html, body {
            margin: 0;
            padding: 0;
            height: 100%;
            width: 100%;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
            background-color: #e9ebee; /* A light, neutral background */
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden; /* Prevent scrollbars generally */
            transition: background-color 0.3s ease; /* Smooth background transition */
        }

        #initial-view {
            text-align: center;
            padding: 25px 30px;
            background-color: #fff;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.15);
            width: 90%;
            max-width: 450px; /* Max width for the card */
        }

        #questionTitle {
            font-size: 1.8em;
            color: #333;
            margin-bottom: 20px;
        }

        #questionImage {
            max-width: 100%;
            height: auto;
            max-height: 60vh; /* Ensure image doesn't get too tall */
            display: block;
            margin: 0 auto 20px auto;
            border-radius: 8px;
            border: 1px solid #ddd;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        #input-container {
            display: flex; /* For aligning input and button */
            gap: 10px; /* Space between input and button */
            margin-bottom: 10px; /* Reduced margin */
        }

        #nameInput {
            flex-grow: 1; /* Input takes available space */
            padding: 12px 15px;
            border: 1px solid #ccc;
            border-radius: 6px;
            font-size: 1em;
            box-sizing: border-box;
        }

        #nameInput:focus {
            border-color: #007bff;
            box-shadow: 0 0 0 0.2rem rgba(0,123,255,.25);
            outline: none;
        }

        #validateButton {
            padding: 12px 20px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 500;
            transition: background-color 0.2s ease;
        }

        #validateButton:hover {
            background-color: #0056b3;
        }

        #giveUpButton {
            display: none; /* Hidden by default */
            padding: 10px 15px;
            background-color: #6c757d; /* Bootstrap secondary color */
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9em;
            margin-top: 10px; /* Space above it */
            margin-bottom: 10px; /* Space below it before error message */
            transition: background-color 0.2s ease;
        }

        #giveUpButton:hover {
            background-color: #5a6268;
        }

        #errorMessage {
            color: #dc3545; /* Bootstrap danger color */
            min-height: 1.2em; /* Reserve space to prevent layout shift */
            font-size: 0.9em;
        }

        #fullscreen-image-container {
            display: none; /* Hidden by default */
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #000; /* Background for the fullscreen image area */
            display: flex; /* For centering the image if it's smaller */
            align-items: center; /* For centering the image if it's smaller */
            justify-content: center; /* For centering the image if it's smaller */
        }

        #fullscreen-image {
            max-width: 100%;  /* Use max-width and max-height with contain */
            max-height: 100%;
            object-fit: contain; /* Ensures the whole image is visible, letterboxed if necessary */
            /* object-position is implicitly center with flexbox on parent, but good to keep if parent wasn't flex */
            object-position: center center;
        }

        /* Shake animation for incorrect input */
        .input-error-shake {
            animation: shake 0.5s;
        }
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
            20%, 40%, 60%, 80% { transform: translateX(5px); }
        }
    </style>
</head>
<body>

    <div id="initial-view">
        <h2 id="questionTitle">Qui est-ce ?</h2>
        <img id="questionImage" src="" alt="Qui est cette personne ?">
        <div id="input-container">
            <input type="text" id="nameInput" placeholder="Entrez le nom complet">
            <button id="validateButton">Valider</button>
        </div>
        <button id="giveUpButton">Je donne ma langue au chat</button>
        <p id="errorMessage"></p>
    </div>

    <div id="fullscreen-image-container" style="display: none;"> <!-- Initially hidden via style attribute for clarity -->
        <img id="fullscreen-image" src="assets/texte_chinois.png" alt="Texte Chinois - Félicitations !">
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const questions = [
                { image: "assets/qui_est_ce1.jpg", answer: "Anselmo Jalabert" },
                { image: "assets/qui_est_ce2.jpg", answer: "Amélie Zwickert" },
                { image: "assets/qui_est_ce3.jpg", answer: "Elise Antoine" },
                { image: "assets/qui_est_ce4.jpg", answer: "Emilien Diaz" },
                { image: "assets/qui_est_ce5.jpg", answer: "Thomas Winkler" },
                { image: "assets/qui_est_ce6.jpg", answer: "Coline Muller" }
            ];

            let currentQuestionIndex = 0;

            const questionTitleElement = document.getElementById('questionTitle');
            const questionImageElement = document.getElementById('questionImage');
            const nameInputElement = document.getElementById('nameInput');
            const validateButtonElement = document.getElementById('validateButton');
            const giveUpButtonElement = document.getElementById('giveUpButton');
            const initialViewElement = document.getElementById('initial-view');
            const fullscreenImageContainerElement = document.getElementById('fullscreen-image-container');
            const errorMessageElement = document.getElementById('errorMessage');

            /**
             * Normalizes a string by trimming, converting to lowercase, and removing diacritics.
             * @param {string} str The string to normalize.
             * @returns {string} The normalized string.
             */
            function normalizeString(str) {
                if (typeof str !== 'string') return '';
                return str
                    .trim()
                    .toLowerCase()
                    .normalize("NFD") // Decomposes combined graphemes into base characters and diacritics
                    .replace(/[\u0300-\u036f]/g, ""); // Removes diacritical marks
            }

            function loadQuestion(index) {
                if (index < questions.length) {
                    const currentQuestion = questions[index];
                    questionTitleElement.textContent = "Qui est-ce ?";
                    questionImageElement.src = currentQuestion.image;
                    questionImageElement.alt = `Indice ${index + 1}`;
                    nameInputElement.value = '';
                    errorMessageElement.textContent = '';
                    nameInputElement.focus();
                    initialViewElement.style.display = 'block';
                    fullscreenImageContainerElement.style.display = 'none'; // Ensure fullscreen is hidden
                    questionTitleElement.style.display = 'block';
                    document.body.style.backgroundColor = '#e9ebee'; // Reset background

                    if (index === questions.length - 1) {
                        giveUpButtonElement.style.display = 'inline-block';
                    } else {
                        giveUpButtonElement.style.display = 'none';
                    }

                } else {
                    showFullscreenImage();
                }
            }

            function showFullscreenImage() {
                initialViewElement.style.display = 'none';
                fullscreenImageContainerElement.style.display = 'flex'; // Changed from 'block' to 'flex' to use align/justify
                document.body.style.backgroundColor = '#000';
            }

            validateButtonElement.addEventListener('click', function() {
                const enteredName = nameInputElement.value; // Raw input
                const correctAnswer = questions[currentQuestionIndex].answer;

                const normalizedEnteredName = normalizeString(enteredName);
                const normalizedCorrectAnswer = normalizeString(correctAnswer);

                if (normalizedEnteredName === normalizedCorrectAnswer) {
                    currentQuestionIndex++;
                    loadQuestion(currentQuestionIndex);
                } else {
                    errorMessageElement.textContent = 'Nom incorrect. Essayez encore !';
                    nameInputElement.classList.add('input-error-shake');
                    setTimeout(() => {
                         nameInputElement.classList.remove('input-error-shake');
                    }, 500);
                    nameInputElement.select(); // Select text for easy correction
                    nameInputElement.focus();
                }
            });

            nameInputElement.addEventListener('keypress', function(event) {
                if (event.key === 'Enter') {
                    event.preventDefault();
                    validateButtonElement.click();
                }
            });

            giveUpButtonElement.addEventListener('click', function() {
                showFullscreenImage();
            });

            // Initial load
            loadQuestion(currentQuestionIndex);
        });
    </script>
</body>
</html>