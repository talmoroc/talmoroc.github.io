<!DOCTYPE html>
<html lang="en">

<head>
    <meta name="google-site-verification" content="OJOBQWKp7iL6P4GOjRqQ3bw1OyFFBHKIJrnj3dPZPV8" />
    <title>monotom</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1, maximum-scale=1">
    <meta name="description" content="A portfolio website with a cables.gl interactive visualization." />
    <link rel="icon" type="image/png" href="assets/profile_picture_small.webp">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">

</head>

<body>

    <div id="loader-overlay">
        <div class="spinner"></div>
    </div>
    
<header class="site-header">
    <img src="assets/profile_picture_small.webp" alt="profile picture" class="profile-picture">
    <img src="assets/monotom_logo_white_transp_bg.webp" alt="monotom logo" class="logo">

    <div class="header-right-content">
        <p class="paragraph-description">composer and sound&nbsp;designer</p>
        <p class="paragraph-socials">
            <a href="https://soundcloud.com/user-555813077" target="_blank">
                <svg viewBox="0 0 143 64" class="svg-logo" width="">
                    <path transform="translate(-166.000000, -1125.000000)"
                        d="M308.984235,1169.99251 C308.382505,1180.70295 299.444837,1189.03525 288.718543,1188.88554 L240.008437,1188.88554 C237.777524,1188.86472 235.977065,1187.05577 235.966737,1184.82478 L235.966737,1132.37801 C235.894282,1130.53582 236.962478,1128.83883 238.654849,1128.10753 C238.654849,1128.10753 243.135035,1124.99996 252.572022,1124.99996 C258.337036,1124.99309 263.996267,1126.54789 268.948531,1129.49925 C276.76341,1134.09703 282.29495,1141.75821 284.200228,1150.62285 C285.880958,1150.14737 287.620063,1149.90993 289.36674,1149.91746 C294.659738,1149.88414 299.738952,1152.0036 303.438351,1155.78928 C307.13775,1159.57496 309.139562,1164.70168 308.984235,1169.99251 Z M229.885123,1135.69525 C231.353099,1153.48254 232.420718,1169.70654 229.885123,1187.43663 C229.796699,1188.23857 229.119091,1188.84557 228.312292,1188.84557 C227.505494,1188.84557 226.827885,1188.23857 226.739461,1187.43663 C224.375448,1169.85905 225.404938,1153.33003 226.739461,1135.69525 C226.672943,1135.09199 226.957336,1134.50383 227.471487,1134.18133 C227.985639,1133.85884 228.638946,1133.85884 229.153097,1134.18133 C229.667248,1134.50383 229.951641,1135.09199 229.885123,1135.69525 Z M220.028715,1187.4557 C219.904865,1188.26549 219.208361,1188.86356 218.389157,1188.86356 C217.569953,1188.86356 216.87345,1188.26549 216.7496,1187.4557 C214.986145,1172.28686 214.986145,1156.96477 216.7496,1141.79593 C216.840309,1140.9535 217.551388,1140.31488 218.398689,1140.31488 C219.245991,1140.31488 219.95707,1140.9535 220.047779,1141.79593 C222.005153,1156.95333 221.998746,1172.29994 220.028715,1187.4557 Z M210.153241,1140.2517 C211.754669,1156.55195 212.479125,1171.15545 210.134176,1187.41757 C210.134176,1188.29148 209.425728,1188.99993 208.551813,1188.99993 C207.677898,1188.99993 206.969449,1188.29148 206.969449,1187.41757 C204.70076,1171.36516 205.463344,1156.34224 206.969449,1140.2517 C207.05845,1139.43964 207.744425,1138.82474 208.561345,1138.82474 C209.378266,1138.82474 210.06424,1139.43964 210.153241,1140.2517 Z M200.258703,1187.47476 C200.169129,1188.29694 199.474788,1188.91975 198.647742,1188.91975 C197.820697,1188.91975 197.126356,1188.29694 197.036782,1187.47476 C195.216051,1173.32359 195.216051,1158.99744 197.036782,1144.84627 C197.036782,1143.94077 197.770837,1143.20671 198.676339,1143.20671 C199.581842,1143.20671 200.315897,1143.94077 200.315897,1144.84627 C202.251054,1158.99121 202.231809,1173.33507 200.258703,1187.47476 Z M190.383229,1155.50339 C192.880695,1166.56087 191.755882,1176.32196 190.287906,1187.58915 C190.168936,1188.33924 189.522207,1188.89148 188.762737,1188.89148 C188.003266,1188.89148 187.356537,1188.33924 187.237567,1187.58915 C185.903044,1176.47448 184.797296,1166.48462 187.142244,1155.50339 C187.142244,1154.60842 187.867763,1153.8829 188.762737,1153.8829 C189.65771,1153.8829 190.383229,1154.60842 190.383229,1155.50339 Z M180.526821,1153.82571 C182.814575,1165.15009 182.071055,1174.7396 180.469627,1186.10211 C180.27898,1187.7798 177.400223,1187.79886 177.247706,1186.10211 C175.798795,1174.91118 175.112468,1165.0357 177.190512,1153.82571 C177.281785,1152.97315 178.001234,1152.32661 178.858666,1152.32661 C179.716099,1152.32661 180.435548,1152.97315 180.526821,1153.82571 Z M170.575089,1159.31632 C172.977231,1166.82778 172.157452,1172.92846 170.479765,1180.63056 C170.391921,1181.42239 169.722678,1182.02149 168.925999,1182.02149 C168.12932,1182.02149 167.460077,1181.42239 167.372232,1180.63056 C165.923321,1173.08097 165.332318,1166.84684 167.23878,1159.31632 C167.330053,1158.46376 168.049502,1157.81722 168.906934,1157.81722 C169.764367,1157.81722 170.483816,1158.46376 170.575089,1159.31632 Z">
                    </path>
                </svg>
            </a>

            <a href="https://github.com/talmoroc" target="_blank">
                <svg viewBox="0 0 24 24" class="svg-logo">
                    <path
                        d="M12 1C5.923 1 1 5.923 1 12c0 4.867 3.149 8.979 7.521 10.436.55.096.756-.233.756-.522 0-.262-.013-1.128-.013-2.049-2.764.509-3.479-.674-3.699-1.292-.124-.317-.66-1.293-1.127-1.554-.385-.207-.936-.715-.014-.729.866-.014 1.485.797 1.691 1.128.99 1.663 2.571 1.196 3.204.907.096-.715.385-1.196.701-1.471-2.448-.275-5.005-1.224-5.005-5.432 0-1.196.426-2.186 1.128-2.956-.111-.275-.496-1.402.11-2.915 0 0 .921-.288 3.024 1.128a10.193 10.193 0 0 1 2.75-.371c.936 0 1.871.123 2.75.371 2.104-1.43 3.025-1.128 3.025-1.128.605 1.513.221 2.64.111 2.915.701.77 1.127 1.747 1.127 2.956 0 4.222-2.571 5.157-5.019 5.432.399.344.743 1.004.743 2.035 0 1.471-.014 2.654-.014 3.025 0 .289.206.632.756.522C19.851 20.979 23 16.854 23 12c0-6.077-4.922-11-11-11Z">
                    </path>
                </svg>
            </a>

            <a href="https://www.instagram.com/_tomcoral/" target="_blank">
                <svg viewBox="0 0 24 24" class="svg-logo">
                    <path
                        d="M12 2.982c2.937 0 3.285.011 4.445.064a6.087 6.087 0 0 1 2.042.379 3.408 3.408 0 0 1 1.265.823 3.408 3.408 0 0 1 .823 1.265 6.087 6.087 0 0 1 .379 2.042c.053 1.16.064 1.508.064 4.445s-.011 3.285-.064 4.445a6.087 6.087 0 0 1-.379 2.042 3.643 3.643 0 0 1-2.088 2.088 6.087 6.087 0 0 1-2.042.379c-1.16.053-1.508.064-4.445.064s-3.285-.011-4.445-.064a6.087 6.087 0 0 1-2.043-.379 3.408 3.408 0 0 1-1.264-.823 3.408 3.408 0 0 1-.823-1.265 6.087 6.087 0 0 1-.379-2.042c-.053-1.16-.064-1.508-.064-4.445s.011-3.285.064-4.445a6.087 6.087 0 0 1 .379-2.042 3.408 3.408 0 0 1 .823-1.265 3.408 3.408 0 0 1 1.265-.823 6.087 6.087 0 0 1 2.042-.379c1.16-.053 1.508-.064 4.445-.064M12 1c-2.987 0-3.362.013-4.535.066a8.074 8.074 0 0 0-2.67.511 5.392 5.392 0 0 0-1.949 1.27 5.392 5.392 0 0 0-1.269 1.948 8.074 8.074 0 0 0-.51 2.67C1.012 8.638 1 9.013 1 12s.013 3.362.066 4.535a8.074 8.074 0 0 0 .511 2.67 5.392 5.392 0 0 0 1.27 1.949 5.392 5.392 0 0 0 1.948 1.269 8.074 8.074 0 0 0 2.67.51C8.638 22.988 9.013 23 12 23s3.362-.013 4.535-.066a8.074 8.074 0 0 0 2.67-.511 5.625 5.625 0 0 0 3.218-3.218 8.074 8.074 0 0 0 .51-2.67C22.988 15.362 23 14.987 23 12s-.013-3.362-.066-4.535a8.074 8.074 0 0 0-.511-2.67 5.392 5.392 0 0 0-1.27-1.949 5.392 5.392 0 0 0-1.948-1.269 8.074 8.074 0 0 0-2.67-.51C15.362 1.012 14.987 1 12 1Zm0 5.351A5.649 5.649 0 1 0 17.649 12 5.649 5.649 0 0 0 12 6.351Zm0 9.316A3.667 3.667 0 1 1 15.667 12 3.667 3.667 0 0 1 12 15.667Zm5.872-10.859a1.32 1.32 0 1 0 1.32 1.32 1.32 1.32 0 0 0-1.32-1.32Z">
                    </path>
                </svg>
            </a>

            <a href="https://linktr.ee/monotom" target="_blank">
                <svg viewBox="0 0 16 19" class="svg-logo">
                    <path
                        d="M9.33238 4.4914L12.4054 1.33238L14.1891 3.15903L10.9656 6.23209H15.5V8.76791H10.9441L14.1891 11.9198L12.4054 13.7106L8 9.28367L3.59456 13.7106L1.81089 11.9269L5.05587 8.77507H0.5V6.23209H5.03438L1.81089 3.15903L3.59456 1.33238L6.66762 4.4914V0H9.33238V4.4914ZM6.66762 12.3997H9.33238V18.4169H6.66762V12.3997Z">
                    </path>
                </svg>
            </a>
        </p>

    </header>


    <main class="main-content">
        <canvas id="glcanvas" width="100vw" height="100vh" tabindex="1" class=></canvas>
        <div id="popup" class="popup">
            <div class="popup-header">
                <h2 id="popup-title"></h2>
                <button id="popup-close" class="popup-close-btn">Ã—</button>
            </div>
            <div class="popup-content">
                <img id="popup-img" src="" alt="">
                <p id="popup-text"></p>
                <div id="popup-soundcloud-array"></div>
            </div>
        </div>
    </main>

    <script type="text/javascript" src="cables/js/patch.js" async></script>

    <script type="text/javascript">

        const loaderOverlay = document.getElementById('loader-overlay');

        const popup = document.getElementById('popup');
        const popupCloseBtn = document.getElementById('popup-close');
        const popupTitle = document.getElementById('popup-title');
        const popupText = document.getElementById('popup-text');
        const popupImg = document.getElementById('popup-img');
        const popupSoundcloudArray = document.getElementById('popup-soundcloud-array');

        let websiteData = null;
        let gCablesPatch = null;
        let isDataSent = false;

        const CABLES_VARS_BY_NAME = {
            IN: {
                POPUP_CLOSED_TRIGGER: 'PopupClosed',
                DATA_READY_TRIGGER: 'DataReady'
            },
            OUT: {
                NODE_CLICKED_ID: 'contentSelectedIndex'
            }
        };

        function showError(initiator, ...args) {
            console.error("CABLES Error:", initiator, ...args);
        }

        function patchInitialized(patch) {
            gCablesPatch = patch;

            const nodeClickedVar = gCablesPatch.getVar(CABLES_VARS_BY_NAME.OUT.NODE_CLICKED_ID);
            if (nodeClickedVar) {
                nodeClickedVar.on('change', (nodeId) => {
                    if (nodeId !== null && nodeId >= 0) {
                        showPopup(nodeId);
                    }
                });
            } else {
                console.error(`Variable '${CABLES_VARS_BY_NAME.OUT.NODE_CLICKED_ID}' not found in patch.`);
            }
        }

        async function patchFinishedLoading(patch) {

            if (isDataSent) {
                console.log("Data already sent. Ignoring duplicate call to patchFinishedLoading.");
                return;
            }
            isDataSent = true; // Set the flag immediately

            console.log("Patch is ready. Fetching data...");
            try {
                const contentResponse = await fetch('data/content.json');
                websiteData = await contentResponse.json();

                const graphResponse = await fetch('data/graph_data.json');
                const graphData = await graphResponse.json();

                sendGraphDataToCables(graphData);
                loaderOverlay.classList.add('hidden');
            } catch (error) {
                console.error("Failed to load data files:", error);
            }
        }

        document.addEventListener("CABLES.jsLoaded", function (event) {
            CABLES.patch = new CABLES.Patch({
                patch: CABLES.exportedPatch,
                "prefixAssetPath": "",
                "assetPath": "assets/",
                "glCanvasId": "glcanvas",
                "glCanvasResizeToWindow": false,
                "glCanvasResizeToParent": true,
                "onError": showError,
                "onPatchLoaded": patchInitialized,
                "onFinishedLoading": patchFinishedLoading,
                "canvas": { "alpha": true, "premultipliedAlpha": true }
            });

            CABLES.patch.config.hidePopup = function () {
                hidePopup(fromCloseButton = false);
            };
        });

        document.getElementById('glcanvas').addEventListener('touchmove', (e) => { e.preventDefault(); }, false);

        function sendGraphDataToCables(graphData) {
            if (!gCablesPatch) {
                console.error("Patch not ready to receive data.");
                return;
            }

            for (const key in graphData) {
                if (Object.hasOwnProperty.call(graphData, key)) {
                    gCablesPatch.setVariable(key, graphData[key]);
                }
            }
            gCablesPatch.config.dataReady();
        }

        function showPopup(nodeId) {
            if (!websiteData || !websiteData.contentNodes) return;
            const content = websiteData.contentNodes[nodeId];
            if (!content) return;

            popupTitle.textContent = content.title;
            popupText.innerHTML = content.description;
            popupImg.src = 'assets/' + content.thumbnail;
            popupSoundcloudArray.innerHTML = '';

            let firstPlayer = true;
            if (content.soundcloudUrl && Array.isArray(content.soundcloudUrl)) {
                popupSoundcloudArray.style.display = 'block';
                for (const url of content.soundcloudUrl) {
                    //<iframe class="soundcloud-player" scrolling="no" frameborder="no" allow="autoplay" style="display: none;"></iframe>
                    nextSoundcloudWidget = document.createElement('iframe');
                    nextSoundcloudWidget.className = 'soundcloud-player';
                    nextSoundcloudWidget.scrolling = 'no';
                    nextSoundcloudWidget.frameBorder = 'no';
                    nextSoundcloudWidget.allow = 'autoplay';
                    let embedUrl = `https://w.soundcloud.com/player/?url=${url}&color=%23000000&auto_play=false&hide_related=true&show_comments=false&show_user=false&show_reposts=false&show_teaser=true&visual=false`;
                    if (firstPlayer) {
                        embedUrl = `https://w.soundcloud.com/player/?url=${url}&color=%23000000&auto_play=true&hide_related=true&show_comments=false&show_user=false&show_reposts=false&show_teaser=true&visual=false`;
                        firstPlayer = false;
                    }
                    nextSoundcloudWidget.src = embedUrl;
                    popupSoundcloudArray.appendChild(nextSoundcloudWidget);
                }
            } else {
                popupSoundcloudArray.style.display = 'none';
            }
            popup.classList.add('visible');
        }

        function hidePopup(fromCloseButton = true) {
            popup.classList.remove('visible');
            popupSoundcloudArray.innerHTML = '';
            popupSoundcloudArray.style.display = 'none';
            if (gCablesPatch) {
                gCablesPatch.config.popupClosed();
            }
        }

        popupCloseBtn.addEventListener('click', hidePopup);

    </script>
</body>

</html>